# Results

```{r}
#Read data from excel
#install.packages("readxl")

library(readxl)
library(tidyr)
library(dplyr)

sheet_names <- excel_sheets("unwto-all-data-download_102023.xlsx")

#create a data frame for each sheet and store them in all_dfs
all_dfs <- lapply(sheet_names, function(sheet) {
  read_excel("unwto-all-data-download_102023.xlsx", sheet = sheet)
})
```

```{r}

#access the desired dataframe from all_dfs
inbound_arrivals <- as.data.frame(all_dfs[2])

#Cleaning up the data set to remove unnecessary rows and columns, and rename/change type of columns
cols_to_del = c(-1,-2,-3)

inbound_arrivals <- inbound_arrivals[,cols_to_del]

col_names <- inbound_arrivals[2, ]

inbound_arrivals <- inbound_arrivals[-2, ]

colnames(inbound_arrivals) <- col_names

names(inbound_arrivals)[names(inbound_arrivals)=="Basic data and indicators"] <- "Country"

names(inbound_arrivals)[2:5] <- c("2", "3", "4", "5")

inbound_arrivals <- inbound_arrivals[-1,-37]

inbound_arrivals <- inbound_arrivals %>%
  mutate_all(~ ifelse(. == "..", NA, .))

columns_indices_to_convert <- 10:36

inbound_arrivals <- inbound_arrivals %>%
  mutate_at(columns_indices_to_convert, as.numeric)
```

```{r}

# Replace empty rows for country with the last non-empty value until a new value appears
inbound_arrivals <- inbound_arrivals %>%
  fill("Country")

#Merging arrival types into one column
columns_to_merge <- c("2","3","4","5") 

inbound_arrivals <- inbound_arrivals %>%
  mutate(Merged_Column = coalesce(!!!syms(columns_to_merge)))

column_names <- names(inbound_arrivals)

#moving the merged column to the front of the dataframe
last_column <- column_names[length(column_names)]

inbound_arrivals <- inbound_arrivals[, !names(inbound_arrivals) %in% columns_to_merge]

column_to_move <- "Merged_Column"
new_position <- 2

inbound_arrivals <- inbound_arrivals %>%
  select(-{{column_to_move}}) %>%
  mutate({{column_to_move}} := inbound_arrivals[[column_to_move]]) %>%
  select({{column_to_move}}, everything())
```

```{r}
total_arrivals <- subset(inbound_arrivals, Merged_Column == 'Total arrivals')
total_arrivals_2022 <- na.omit(total_arrivals[,c(1,2,29,30,31,32,33)])
```

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(forcats)

top_countries <- total_arrivals_2022 %>%
  select(Country, `2018`, `2019`, `2020`, `2021`, `2022`) %>%
  pivot_longer(cols = -Country, names_to = "Year", values_to = "Arrivals") %>%
  group_by(Year) %>%
  mutate(rank = dense_rank(desc(Arrivals))) %>%
  filter(rank <= 10) %>%
  arrange(Year, desc(Arrivals))

top_countries <- top_countries %>%
  arrange(Year, Arrivals) %>%
  mutate(Country = factor(Country, unique(Country))) 

# Plotting faceted diverging bar chart
ggplot(top_countries, aes(x = fct_reorder(Country, Arrivals), y = (Arrivals)*1000, fill = (Arrivals)*1000)) +
  geom_col() +
  coord_flip() +
  facet_wrap(.~ Year, scales = "free") +
  labs(title = "Top 10 Visited Countries by Year",
       x = "Country",
       y = "Arrivals",
       fill = "Arrivals") +
  theme_minimal()+
  scale_fill_continuous(labels = function(x) format(x, scientific = FALSE))+
  theme(axis.text.x = element_blank())
```

In the plots above, we see the top 10 most visited countries by total arrivals for the years 2018-2022. Over these five years, the countries in the top ten do not shift very much. The main shift comes from China, where after 2020, visits drop significantly. Macao and Hong Kong drop off of the list entirely by 2022. China was the most visited country in 2018 and 2019, but is overtaken by Italy in 2020 and then Spain in 2021 and 2022. It is not difficult to see the impact of the corona virus pandemic in this data. Not only with countries visited, but also in the number of travelers. The most visited countries decreased by up to four times between 2019 and 2020. Some recovery in travel began in 2021, but was not notable until 2022, especially in Spain.

```{r}
inbound_arrivals$`1995`<- as.numeric(inbound_arrivals$`1995`)

long_data <- pivot_longer(inbound_arrivals, cols = c(-Merged_Column,-Country, -Units, -Notes, -Series), names_to = "Year", values_to = "Arrivals")

long_data$Year <- as.Date(long_data$Year, format='%Y')

top_four <- c("SPAIN","ITALY","TÜRKIYE","CROATIA")

long_data_four <- subset(long_data, Country %in% top_four)
long_data_four <- subset(long_data_four, Merged_Column == "Total arrivals")
long_data_four <- subset(long_data_four, Year >= '2000-12-01')

ggplot(long_data_four, aes(x = Year, y = (Arrivals)*1000, group = Country, color = Country)) +
  geom_point() +
  facet_wrap(~ Country, scales = "free_y")+
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
  labs(title="Visits since 2000 in most popular countries", y="Arrivals")
```

Looking at the top four most visited countries in 2022, we see similar trends in travel from 2000 to 2022. All four countries have seen a great increase in arrivals since 2000. However, Spain and Italy both already had over 60 million arrivals per year starting in 2000, and have only grown since. Croatia was already seeing almost 40 million arrivals per year in 2000, peaking at 60 million in 2019. Turkey has seen the most growth, starting at 10 million arrivals per year in 2000, and peaking over 50 million in both 2019 and 2022. In fact, Turkey is the only country that has returned to its pre-pandemic level of arrivals. All four countries saw a drastic decrease in arrivals in 2020, with 2020 numbers being the lowest recorded since 2000 for Croatia, Italy, and Spain. Turkey has had more fluctuation in travel numbers since 2017, possibly due to earthquakes as well as Covid. Croatia and Spain had small peaks in 2008, perhaps slowing down in 2009 and 2010 due to the global financial crisis. From the growth before the pandemic, we can expect these countries to continue to see more tourism in the post-pandemic world.

```{r}
climate_df <- read.csv("Climate-related_Disasters_Frequency.csv")
climate_df <- climate_df[,c(2,5,11:53)]
names(climate_df) <- gsub("F", "", names(climate_df))

long_data_climate <- pivot_longer(climate_df, cols = c(-Country, -Indicator), names_to = "Year", values_to = "Disasters")
long_data_climate$Year <- as.Date(long_data_climate$Year, format='%Y')
```

```{r}
GDP_df <- read_excel("imf-dm-export-20231128.xls") 

GDP_df<-as.data.frame(GDP_df[-1,])

names(GDP_df)[names(GDP_df)=="Real GDP growth (Annual percent change)"] <- "Country"

GDP_df <- GDP_df %>%
  mutate_all(~ ifelse(. == "no data", NA, .))

long_data_GDP <- pivot_longer(GDP_df, cols = -Country, names_to = "Year", values_to = "GDP")
long_data_GDP$Year <- as.Date(long_data_GDP$Year, format='%Y')
```

```{r}
happiness_df <- read_excel("DataForFigure2.1WHR2023.xls")

happiness_df<-as.data.frame(happiness_df)
```

```{r}
top_bottom_countries_all <- inbound_arrivals %>%
  filter(Merged_Column == "Total arrivals") %>%
  arrange(abs(`2022`)) %>%
  filter(row_number() <= 10 | row_number() > n() - 10)

top_bottom_countries_all$`1995`<- as.numeric(top_bottom_countries_all$`1995`)

long_data_arrivals <- pivot_longer(top_bottom_countries_all, cols = c(-Merged_Column,-Country, -Units, -Notes, -Series), names_to = "Year", values_to = "Arrivals")

long_data_arrivals$Year <- as.Date(long_data_arrivals$Year, format='%Y')
```

```{r}
library(ggridges)

top_ten_arrivals <- c("Spain","Italy","Türkiye, Republic of","Croatia","Hungary","Denmark","Greece","China, People's Republic of","Canada","Saudi Arabia")

GDP_ten <- subset(long_data_GDP, Country %in% top_ten_arrivals)
GDP_ten <- subset(GDP_ten, Year >= '2000-12-01')
GDP_ten <- subset(GDP_ten, Year <= '2023-12-01')
GDP_ten$GDP <- as.numeric(GDP_ten$GDP)

desired_values <- c(-15, -10, -5, 0, 5, 10, 15) 

ggplot(GDP_ten, aes(x = GDP, y = Country, fill = Country)) +
  geom_density_ridges(scale = 1.5, alpha = 0.6) +
  theme_ridges() +
  labs(title = "GDP for Top 10 Visited Countries", x = "GDP", y = "Country") +
  scale_fill_brewer(palette = "Set3") +
  scale_x_discrete(breaks = desired_values)
```

The ridgeline plot above shows us the distribution of GDP for the top ten most visited countries in 2022. The GDP data spans from 2000 to 2022. From this plot, we can see that China has the highest median GDP of the ten countries.

```{r}
GGally::ggparcoord(data=happiness_df,columns = 6:11, scale="std", alphaLines = 0.5)+
  labs(title = "Happiness indicators in all countries", x = "Indicators", y = "Value")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
library(redav)
happiness_data <- happy_ten[,c(1,7:11)]
happiness_data <- na.omit(happiness_data)
draw_biplot(happiness_data)+
  labs(title = "Happiness Indicators in Most Visited Countries")

```
